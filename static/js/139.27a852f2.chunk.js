"use strict";(self.webpackChunkproject_mania=self.webpackChunkproject_mania||[]).push([[139],{5710:function(e,n,i){i.r(n),i.d(n,{default:function(){return I}});var t=i(2791),s=i(9143),r=i(4934),a=i(2126),c=i(6747),l=i(995),o=i(6856),d=i(184),u=function(){var e,n=(0,r.Z)().currentProject,i=(0,t.useRef)(null);return(0,t.useEffect)((function(){var e;null!==n&&void 0!==n&&null!==(e=n.activity)&&void 0!==e&&e.length&&function(){var e;null===(e=i.current)||void 0===e||e.scrollIntoView()}()}),[n]),(0,d.jsxs)("div",{className:"activity-container",children:[(0,d.jsxs)("div",{className:"title-with-icon",children:[(0,d.jsx)(l.Z,{icon:(0,d.jsx)(o.BMe,{className:"icon xl blue"})}),(0,d.jsx)("h3",{children:"Recent Activity"})]}),(0,d.jsxs)("div",{className:"timeline",children:[(0,d.jsx)("div",{className:"dashed-line"}),(0,d.jsxs)("div",{className:"activities",children:[null===n||void 0===n||null===(e=n.activity)||void 0===e?void 0:e.map((function(e){return(0,d.jsxs)("div",{className:"activity",children:[(0,d.jsxs)("div",{className:"activity-text",children:[e.created_by.image?(0,d.jsx)("div",{className:"profile-img-container",children:(0,d.jsx)("img",{src:Buffer.from(e.created_by.image)||e.created_by.image.toString(),alt:"profile"})}):(0,d.jsx)(s.Z,{}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:e.created_by.user_name})," ",e.text]})]}),(0,d.jsxs)("span",{className:"activity-time",children:[(0,a.Ht)(e.created_at)," - ",(0,a.T0)(e.created_at)]})]},(0,c.H)())})),(0,d.jsx)("div",{ref:i})]})]})]})},v=i(9434),m=i(2696),f=i(4165),j=i(5861),x=i(1413),h=i(3433),p=i(9439),g=i(2048),b=i(7800),Z=i(9126),N=i(7046),_=i(7145),w=function(){var e=(0,b.Z)(),n=e.userInfo,i=e.user,a=e.userName,o=(0,r.Z)(),u=o.currentProject,w=o.handleOpenAdminModal,k=(0,t.useState)([]),y=(0,p.Z)(k,2),E=y[0],I=y[1],C=(0,t.useState)([]),O=(0,p.Z)(C,2),F=O[0],L=O[1],S=(0,v.I0)();_.Wb.on("online",(function(e){F.some((function(n){return n._id===e.userId}))&&L((0,h.Z)(F.map((function(n){return n._id===e.userId?(0,x.Z)((0,x.Z)({},n),{},{online:!0}):n}))))})),_.Wb.on("offline",(function(e){F.some((function(n){return n._id===e.userId}))&&L((0,h.Z)(F.map((function(n){return n._id===e.userId?(0,x.Z)((0,x.Z)({},n),{},{online:!1}):n}))))}));var M=function(e){return(0,d.jsx)(Z.KC7,{className:e.online?"icon online-status green":"icon online-status grey"})},z=function(e){return e.base64_img_data?Buffer.from(e.base64_img_data):e.img_url.toString()},A=function(){var e=(0,j.Z)((0,f.Z)().mark((function e(){var n,i,t,s;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],i=(0,f.Z)().mark((function e(){var i;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.CX)(E[t]);case 2:if(i=e.sent,!F.some((function(e){return e.email===i.email}))){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:n.push(i);case 7:case"end":return e.stop()}}),e)})),t=0;case 3:if(!(t<E.length)){e.next=11;break}return e.delegateYield(i(),"t0",5);case 5:if("object"!==typeof(s=e.t0)){e.next=8;break}return e.abrupt("return",s.v);case 8:t++,e.next=3;break;case 11:L(n);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,t.useEffect)((function(){u&&E.length&&A()}),[E,u]),(0,t.useEffect)((function(){if(!u&&(E.length||F.length))return I([]),void L([]);null!==u&&void 0!==u&&u.admins.length&&I(u.admins)}),[u]),(0,t.useEffect)((function(){1===(null===u||void 0===u?void 0:u.members.length)&&!1===(null===u||void 0===u?void 0:u.members[0].admin)&&S((0,m.Ce)((0,x.Z)((0,x.Z)({},u),{},{admins:[].concat((0,h.Z)(u.admins),[u.members[0].email])})))}),[u]),(0,t.useEffect)((function(){var e=function(){_.Wb.emit("unload",{userId:null===n||void 0===n?void 0:n._id})};return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}}),[null===n||void 0===n?void 0:n._id]),(0,d.jsxs)("div",{className:"current-project-admins",children:[(0,d.jsx)("span",{children:"BOARD ADMINS"}),(0,d.jsx)("div",{className:"admins",children:null!==F&&void 0!==F&&F.length?null===F||void 0===F?void 0:F.map((function(e){return e.email===(null===i||void 0===i?void 0:i.email)?(0,d.jsxs)("div",{className:"admin",children:[e.img_url||e.base64_img_data?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.Z,{src:z(n)}),(0,d.jsx)(l.Z,{title:null!==n&&void 0!==n&&n.online?"Online":"Offline",icon:M(n)})]}):(0,d.jsx)(s.Z,{}),(0,d.jsxs)("span",{children:[a," (You)"]})]},(0,c.H)()):(0,d.jsxs)("div",{className:"admin",children:[e.img_url||e.base64_img_data?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.Z,{src:z(e)}),(0,d.jsx)(l.Z,{title:e.online?"Online":"Offline",icon:M(e)})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.Z,{}),(0,d.jsx)(l.Z,{title:e.online?"Online":"Offline",icon:M(e)})]}),(0,d.jsxs)("span",{children:[e.first_name," ",e.last_name]})]},(0,c.H)())})):null}),(0,d.jsx)("button",{className:"btn link",onClick:w,children:"I'm an admin"})]})},k=i(4083),y=i(7480),E=i(4888),I=function(){var e=(0,r.Z)().currentProject,n=(0,v.I0)(),i=(0,v.v9)(k.V),s=(0,E.Z)().isMobile;return(0,t.useEffect)((function(){n((0,m.VE)(e.activity))}),[e]),(0,d.jsx)(d.Fragment,{children:s?(0,d.jsx)(d.Fragment,{children:e&&(0,d.jsxs)("nav",{id:"activity-section-mobile",className:i?"open":"",children:[(0,d.jsx)(l.Z,{additionalClass:i?"toggle-collapse rotate":"toggle-collapse",icon:(0,d.jsx)(Z.pjk,{className:"icon"}),onClick:function(){n((0,y.US)(!i))}}),(0,d.jsxs)("div",{className:"right-nav-content",children:[(0,d.jsxs)("div",{className:"project-content",children:[(0,d.jsxs)("div",{className:"current-project-info",children:[(0,d.jsx)("h3",{children:null===e||void 0===e?void 0:e.title}),(0,d.jsx)("p",{children:null===e||void 0===e?void 0:e.subtitle})]}),(0,d.jsx)(w,{})]}),(0,d.jsx)("div",{className:"activity-section",children:(0,d.jsx)(u,{})})]})]})}):(0,d.jsx)(d.Fragment,{children:e&&(0,d.jsx)("nav",{id:"right-nav",className:i?"open":"",children:(0,d.jsxs)("div",{className:"right-nav-content",children:[(0,d.jsxs)("div",{className:"project-content",children:[(0,d.jsxs)("div",{className:"current-project-info",children:[(0,d.jsx)("h3",{children:null===e||void 0===e?void 0:e.title}),(0,d.jsx)("p",{children:null===e||void 0===e?void 0:e.subtitle})]}),(0,d.jsx)(w,{})]}),(0,d.jsx)("div",{className:"activity-section",children:(0,d.jsx)(u,{})})]})})})})}},9143:function(e,n,i){i.d(n,{Z:function(){return r}});i(2791);var t=i.p+"static/media/blank-profile-picture.48af6c0bf2932eced28a.png",s=i(184),r=function(e){var n=e.size;return(0,s.jsx)("div",{className:"profile-img-container blank",children:(0,s.jsx)("img",{id:"blank-profile",src:t,alt:"blank profile",width:n||null,height:n||null})})}},2048:function(e,n,i){i(2791);var t=i(184);n.Z=function(e){var n=e.src,i=e.size;return(0,t.jsx)("div",{className:"profile-img-container",children:(0,t.jsx)("img",{src:n,alt:"profile",width:i||null,height:i||null})})}},4888:function(e,n,i){var t=i(2791),s=i(9434),r=i(7480),a=i(4083);n.Z=function(){var e=(0,s.v9)(a.eD),n=(0,s.I0)();return(0,t.useEffect)((function(){var e=function(){window.innerWidth<1441?n((0,r.Ep)(!0)):n((0,r.Ep)(!1))};return window.addEventListener("resize",e),window.addEventListener("load",e),function(){window.removeEventListener("resize",e),window.removeEventListener("load",e)}}),[]),{isMobile:e}}}}]);
//# sourceMappingURL=139.27a852f2.chunk.js.map